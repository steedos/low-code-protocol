---
title: 字段类型
description: 低代码平台基础字段类型、属性与功能描述。
---

## 字段类型索引

 - **文本(text)**：普通的文本框字段。
 - **长文本(textarea)**：多行文本框字段。
 - **HTML文本(html)**：富文本框字段，页面内可包含图片、链接等。
 - **选择框(select)**：下拉选择框字段，提供多个选项供用户选择，支持多选模式。
 - **复选框(boolean)**：显示为勾选框，打勾选中保存为true，反之保存为false。
 - **开关(toggle)**：显示为开关按钮，点击即可切换开关状态，开保存为true，反之保存为false。
 - **日期(date)**：不带小时和分的日期字段，保存为Date类型值。
 - **日期时间(datetime)**：带小时和分的日期字段，保存为Date类型值。
 - **数值(number)**：显示为数值输入框，可以指定小数位，默认保留2位小数，不指定小数位数时按整数处理。
 - **金额(currency)**：显示为数值输入框，可以指定小数位，默认保留2位小数，不指定小数位数时按2位小数处理。
 - **百分比(percent)**：显示为数值输入框，可以指定小数位，默认保留2位小数，提供百分比的显示方式，保存的是普通的小数数值，比如0.20表示20%。
 - **密码(password)**：显示为密码输入框，输入框中会显示*号，而不会显示具体密码值。
 - **相关表(lookup)**：引用其他对象的外键字段，显示为关联表记录选项输入框，支持多选模式。
 - **主表/子表(master_detail)**：与相关表字段一样，是一种外键字段，在子表对象上设置一个该类型的字段可以与主表对象建立主子表关系，与相关表字段唯一的区别是多了一层主子表从属关系。
 - **自动编号(autonumber)**：显示为只读字段，管理员通过在该字段中配置编号规则公式来自动使该字段生成和保存为相关编号值，不支持手动编写该字段值。
 - **网址(url)**：显示为普通文本输入框，只读时，以带有链接的url或二维码的形式呈现。
 - **邮件地址(email)**：显示为普通文本输入框，只读时显示为链接，点击链接将自动打开邮件客户端，并将字段值带入收件人中。
 - **图片(image)**：显示为图片上传控件，支持多选模式，只读时显示为图片或图片列表。
 - **附件(file)**：显示为附件上传控件，支持多选模式，只读时显示为附件或附件列表，支持附件下载。
 - **公式(formula)**：显示为只读字段，业务人员通过在后台为该字段配置类似Excel公式的脚本，该脚本会在服务端执行并把执行结果保存为该字段值，用于快速实现一些简单的业务逻辑，比如自动根据其他字段值派生新值，或基于多个字段值按业务规则执行某种逻辑计算来派生新值，不支持手动编写该字段值。
 - **累计汇总(summary)**：显示为只读字段，业务人员通过在后台为该字段配置一种累计汇总计算规则，可以对关联子表进行各种汇总计算，并把计算结果保存到该字段值中，具有求和(SUM)、计数(COUNT)、均值（AVG）、最大值(MAX)和最小值(MIN)五种汇总计算能力，当该字段上配置的汇总计算规则依赖的相关子表记录发生变化时，服务端会自动根据该字段上配置的规则重新执行汇总计算，不支持手动编写该字段值。
 
 以上是低代码平台，各种字段类型的基本功能说明，其详细的元数据属性协议请参阅 [对象元数据 - 字段](/docs/metadata-object#字段%20.field.yml)。

## 字段类型详解

 以上字段类型中有些功能是比较复杂的，下面是这些复杂的字段类型的具体功能协议。

 关于各种不同字段类型下元数据协议请参阅 [字段元数据](/docs/metadata-object#字段%20.field.yml)。

### 长文本字段类型

长文本字段类型可以在可视化界面额外配置以下属性：

- **rows**: 多行文本行数， 定义“长文本”字段类型显示的文本框行数，默认显示为3行。

### 选择框字段类型

当需要字段值不能用户随意输入的时候，可以设置一个字段的类型为选择框，设置固定的值供用户选择，支持为每个选项配置显示名、选项值和背景颜色。

在可视化界面可以为该字段类型额外配置以下属性：

- **多选 multiple**：勾选该属性表示可以为该字段配置多个选项值，当变更该属性时需要注意历史数据，需要手动编辑历史数据或通过执行数据库脚本批量修正历史数据中该字段值。
- **数据类型 data_type**：默认情况下该字段类型会被保存为字符串，可以通过配置数据类型属性来变更选项值保存后的数据类型，支持复选框（CheckBox）、数值（Number）和文本（Text）三种数据类型。
- **选择项 options**：在这里配置选择框类型字段的下拉选项。

在为选择框类型字段配置选项时，可以为每个选项配置以下属性：

- **显示名 label**：选项显示名。
- **选项值 value**：该选项选中后保存到数据库中的值。
- **颜色 color**：选中项选中后在界面上显示该选项时要显示的背景颜色，用于高亮显示某些选项，只支持16进制颜色值，如90EE90。

以下是该字段类型在 `.field.yml` 配置文件中才可配置的属性：

- **选择项函数 ：optionsFunction**

可以在该属性中描述用户在填写选择框字段值列出哪些选项供选择，比如以下是名为数据类型的选择框字段配置文件内容，其 `optionsFunction` 属性描述了不同字段类型下支持的数据类型选项清单。

```yml
//date_type.field.yml
type: select
label: Data Type
inlineHelpText: This field must be filled when the field type is 'Formula'
depend_on:
  - type
optionsFunction: !<tag:yaml.org,2002:js/function> |-
  function (values) {
    if(values.type === "select"){
        return [
            {
              "label": "Checkbox",
              "value": "boolean"
            },
            {
              "label": "Number",
              "value": "number"
            },
            {
              "label": "Text",
              "value": "text"
            }
        ];
    }
    else{
        return [
            {
              "label": "Checkbox",
              "value": "boolean"
            },
            {
              "label": "Number",
              "value": "number"
            },
            {
              "label": "Currency",
              "value": "currency"
            },
            {
              "label": "Percent",
              "value": "percent"
            },
            {
              "label": "Text",
              "value": "text"
            },
            {
              "label": "Date",
              "value": "date"
            },
            {
              "label": "Datetime",
              "value": "datetime"
            }
        ];
    }
  }
```

### 相关表字段类型

当我们需要描述两个对象之间的关联关系时，可以在其中一个对象中创建一个“相关表”字段来关联两个对象。比如每个“报价”记录都应该有对应的“所属客户”与之关联，此时我们可以在“报价”对象上创建一个“报价客户”字段跟“客户”对象关联起来。

* **所属对象**：字段所属对象，默认值为所属对象。
* **显示名称**：字段显示名称，这里输入”报价客户“。
* **字段名**：字段唯一标识，界面上输入的字段名会添加“__c”作为最终的标识， 这里输入"account_id"。
* **字段类型**：这里选择”相关表“。
* **引用对象**：该相关表字段要关联到的另一个对象，这里设置了“客户”表示通过该相关表字段把“报价”与“客户”两个对象关联起来。
* **过滤器函数**：默认情况下，用户在新建和编辑对象记录界面上填写相关表字段值时会列出相关表的所有记录供选择，可以在这里配置可选项范围，比如输入以下内容作为过滤器函数值可让用户在新建和编辑 “报价” 记录界面上填写“报价客户”字段值时只列出有效客户供选择。

```javascript
function(filters, values){
  return [["state","=","active"]];
}
```

关于该函数返回值，目前推荐使用数组语法。详情请查看 “[查询过滤条件详解](/docs/api-records-filters)”。

* **选择项函数**：与上述过滤器函数类似，可以在这里描述用户在填写相关表字段值列出哪些选项供选择，比如输入以下内容作为选择项函数值可以实现上述过滤器函数中内容同样的效果。

```javascript
function(values){
  var result = [];
  var queryFilters = [["state", "=", "active"]];
  var steedosFilters = require("@steedos/filters");
  var odataFilter = steedosFilters.formatFiltersToODataQuery(queryFilters);
  var options = {
    $select: 'name'
  };
  options.$filter = odataFilter;
  var accounts = Creator.odata.query('accounts', options, true);
  accounts.forEach(function (item) {
    result.push({
      label: item.name,
      value: item._id
    });
  });
  return result;
}
```

* **多选**：如果对象使用的是华炎魔方默认数据源，即使用的是mongodb数据库，那么可以勾选该属性来允许用户选择多个关联值，比如用户可以在新建或编辑某个“报价”记录界面上，选择多个“报价客户”来关联到该“报价”记录。

相关表字段展示选择项时有两种模式：一种是**普通下拉选择框模式**；另一种是**弹出窗口查找模式**，该模式需要在对象设置界面将该对象的“**启用弹出窗口查找模式**”功能开启。以下是两种模式的示例图：

 ![下拉选择框](https://console.steedos.cn/api/files/images/C2Zkb6F5dF7GcaFWG)

 ![弹出窗口查找](https://console.steedos.cn/api/files/images/Yx4AccjxkYsaR37Fa)

> 该字段类型的字段也被称为外键字段，其值保存的是关联对象记录的主键字段值而不是名称字段值。

### 主表/子表字段类型

在相关表字段的基础上，我们可以通过创建一个“主表/子表”字段来描述两个对象间的主从关系，需要注意的是应该把“主表/子表”字段添加到“子表”对象侧，来表示“子表”对象是通过这个字段来关联其“主表”的。比如 “报价行条目” 都应该有对应的 “报价” 与之关联，此时我们可以在 ”报价行条目“ 对象上建立一个 “报价名称” 字段，类型为主表/子表跟 “报价” 对象关联起来。

**区别**：设置为主表/子表类型的字段可以在主表的“相关子表”里设置关联子表显示的列。

* **所属对象**：字段所属对象，默认值为所属对象。
* **显示名称**：字段显示名称，这里输入”报价名称“。
* **字段名**：字段唯一标识，界面上输入的字段名会添加“__c”作为最终的标识， 这里输入"offer_name"。
* **字段类型**：这里选择”主表/子表“。
* **引用对象**：该相关表字段要关联到的另一个对象，这里设置了“客户”表示通过该相关表字段把“报价”与“客户”两个对象关联起来。
* **过滤器函数**：默认情况下，用户在新建和编辑对象记录界面上填写相关表字段值时会列出相关表的所有记录供选择，可以在这里配置可选项范围，比如输入以下内容作为过滤器函数值可让用户在新建和编辑 “报价” 记录界面上填写“报价客户”字段值时只列出有效客户供选择。

```javascript
function(filters, values){
  return [["state","=","active"]];
}
```

关于该函数返回值，目前推荐使用数组语法。详情请查看 “[查询过滤条件详解](/docs/api-records-filters)”。

* **选择项函数**：与上述过滤器函数类似，可以在这里描述用户在填写相关表字段值列出哪些选项供选择，比如输入以下内容作为选择项函数值可以实现上述过滤器函数中内容同样的效果。

```javascript
function(values){
  var result = [];
  var queryFilters = [["state", "=", "active"]];
  var steedosFilters = require("@steedos/filters");
  var odataFilter = steedosFilters.formatFiltersToODataQuery(queryFilters);
  var options = {
    $select: 'name'
  };
  options.$filter = odataFilter;
  var accounts = Creator.odata.query('accounts', options, true);
  accounts.forEach(function (item) {
    result.push({
      label: item.name,
      value: item._id
    });
  });
  return result;
}
```

> 该字段类型的字段也被称为外键字段，其值保存的是关联对象记录的主键字段值而不是名称字段值。

### 自动编号字段类型

自动编号，是一种特殊的数据规范，表单或报表中经常需要使用序列号，比如单号、编号等，当需要定义一个规则来自动生成所需的序列号时，我们称之为自动编号。

**自动编号公式**

要自动编号需要我们引用相关公式，公式一般有两种，一种是日期编号，第二种是序号编号。

* **日期**： {YYYY}表示当年四位年（如2020），{YY}表示当年两位年（如20） {MM}表示当月 {DD}表示当日
* **序号**： {0000}表示4位序号,{00}表示2位序号等，不足前面会补0，每增加一个编号数值递增1，默认起始编号为1，比如使用公式{0000}时，第一个编号为0001，第二个为0002。

可以单独显示日期或序号编号，也可以结合起来运用，方便后期查找。例如我们可以新建一个合同编号字段，在字段类型选择框选择自动编号，在公式一栏输入{YYYY}-{0000}, 当新建一个合同时，会自动生成如2021-0001这样的编号。

 ![](https://console.steedos.cn/api/files/images/JNjAPqhNKW53sh8CQ)

也可以加入其他的字符串，例如“SN{YYYY}{MM}{DD}{000}” 或是“采购合同\[{YYYY}\]{000}号”。结果会显示为类似“采购合同2021-0001”这样的数据。

**关于起始编号**

默认起始编号为1，需要变更起始编号时可以修改目标”自动编号“的“当前编号值”内容，设置方法就是下面的“自动编号配置”。

**公式生效范围**

使用{YYYY}等日期公式时，可以设置其生效范围，当无效时公式返回空字符串，设置方法就是下面的“自动编号配置”。

**自动编号配置**

需要变更起始编号或设置日期公式生效范围时需要编辑目标”自动编号“来配置相关属性，点开“设置-高级设置-自动编号”。

自动编号记录规则：当您为一个对象创建一个自动编号字段后，如果没有新建该对象记录，自动编号记录中不会生成该对象的自动编号记录。

如果您想变更起始编号，请在自动编号中新建一条记录，“对象名”、“自动编号字段”请输入对应您之前创建的那一个自动编号字段名及其对象名，“当前编号值”请输入起始编号。“日期范围开始日期”和“日期范围截止日期”如果不填就是默认当年的开始时间和结束时间。

如果您想中途变更编号，请在自动编号中筛选对应的记录，修改其“当前编号值”内容。

新建一条记录时，编号从1开始记录。如果输入的是100，表示从101开始记录。而且当前编号值会随着新增记录的增加而改变，比如已经有10条记录了，当前编号值会显示为10。

 ![](https://console.steedos.cn/api/files/images/fNxfEb4R8pQz99osX)

**变更编号规则**

描述需要变更编号规则时应该修改自动编号公式，如果这么做的话历史数据中已经有的记录无法重新编号。